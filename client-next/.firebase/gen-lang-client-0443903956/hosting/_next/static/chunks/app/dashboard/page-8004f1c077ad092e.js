(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{7701:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>b});var n=a(5155),i=a(2115),o=a(7024),t=a(5e3),l=a.n(t),s=a(63),d=a(2451),c=a(51),g=a(7621);let m=function(e){let{onComplete:r,existingLanguages:a=[]}=e,{user:t}=(0,o.J)(),l=(0,s.useRouter)();if(!t)return(0,n.jsx)("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-blue-800 mb-4",children:"Authentication Required"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Please log in to continue with language onboarding."}),(0,n.jsx)("button",{onClick:()=>l.push("/login"),className:"bg-rose-500 text-white px-6 py-2 rounded-lg hover:bg-rose-600 transition-colors",children:"Go to Login"})]})});let[d,m]=(0,i.useState)(1),[p,f]=(0,i.useState)({language:"",proficiency:"",talkTopics:[],learningGoals:[],practicePreference:"",feedbackLanguage:"en"}),[h,u]=(0,i.useState)(""),[y,v]=(0,i.useState)(!1),b=c.Yj.filter(e=>!a.includes(e.code)),x=(e,r)=>{f(a=>({...a,[e]:r}))},j=()=>{switch(d){case 1:return""!==p.language&&""!==p.feedbackLanguage;case 2:return""!==p.proficiency;case 3:return p.talkTopics.length>0&&p.learningGoals.length>0;case 4:return""!==p.practicePreference;default:return!1}},S=()=>{switch(d){case 1:return"Please select a language to learn and a feedback language.";case 2:return"Please select your proficiency level.";case 3:return"Please select at least one topic to talk about and one learning goal.";case 4:return"Please select your practice preference.";default:return"Please complete this step."}},w=async()=>{if(!j())return void u(S());v(!0),u("");try{if(!(null==t?void 0:t.id))throw Error("User not authenticated");let{success:e,data:a}=await (0,g.Z_)({user_id:t.id,language:p.language,proficiency_level:p.proficiency,talk_topics:p.talkTopics,learning_goals:p.learningGoals,practice_preference:p.practicePreference,feedback_language:p.feedbackLanguage,is_primary:!1});if(!e)throw Error("Failed to create language dashboard");r?r(a):l.push("/dashboard")}catch(e){console.error("Language onboarding error:",e),u(e.message||"Failed to create language dashboard. Please try again."),v(!1)}};return 0===b.length&&1===d?(0,n.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, var(--cream) 0%, #e8e0d8 50%, #d4c8c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem",fontFamily:"Montserrat, Arial, sans-serif"},children:(0,n.jsxs)("div",{style:{background:"#fff",borderRadius:20,padding:"2.5rem",boxShadow:"0 20px 60px rgba(60,76,115,0.15)",maxWidth:500,width:"100%",textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2.5rem",marginBottom:"1rem"},children:"\uD83C\uDF0D"}),(0,n.jsx)("h1",{style:{color:"var(--blue-secondary)",fontSize:"2rem",fontWeight:700,marginBottom:"1rem",fontFamily:"Gabriela, Arial, sans-serif"},children:"All Languages Added!"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",fontSize:"1rem",marginBottom:"2rem",fontFamily:"AR One Sans, Arial, sans-serif"},children:"You already have dashboards for all available languages. You can edit your existing language settings from the dashboard."}),(0,n.jsx)("button",{onClick:()=>l.push("/dashboard"),style:{background:"linear-gradient(135deg, var(--rose-primary) 0%, #8a6a7a 100%)",color:"#fff",border:"none",borderRadius:10,padding:"0.75rem 2rem",fontSize:"1rem",fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif"},children:"Back to Dashboard"})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n  /* Step 3 responsive grids (match main onboarding) */\n  .topics-grid, .goals-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 0.6vh;\n    margin-bottom: 0.2vh;\n    align-items: stretch;\n  }\n  @media (min-width: 481px) and (max-width: 1024px) {\n    .topics-grid, .goals-grid {\n      grid-template-columns: repeat(3, 1fr);\n      gap: 0.6vh;\n    }\n  }\n  @media (min-width: 1025px) and (max-width: 1439px) {\n    .topics-grid, .goals-grid {\n      grid-template-columns: repeat(4, 1fr);\n      gap: 0.6vh;\n    }\n  }\n  @media (min-width: 1440px) {\n    .topics-grid, .goals-grid {\n      grid-template-columns: repeat(5, 1fr);\n      gap: 0.6vh;\n    }\n  }\n  .language-onboarding-step-container {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    overflow: hidden;\n    padding: clamp(1rem, 3vw, 2rem) 0;\n    box-sizing: border-box;\n  }\n\n  .language-onboarding-title {\n    color: var(--blue-secondary);\n    font-size: clamp(1.2rem, 3vw, 1.6rem);\n    font-weight: 700;\n    margin-bottom: clamp(0.1rem, 0.5vw, 0.3rem);\n    text-align: center;\n    font-family: 'Gabriela', Arial, sans-serif;\n    line-height: 1.1;\n  }\n\n  .language-onboarding-subtitle {\n    color: var(--rose-primary);\n    text-align: center;\n    margin-bottom: clamp(0.3rem, 0.8vw, 0.5rem);\n    font-size: clamp(0.8rem, 1.8vw, 1rem);\n    font-family: 'AR One Sans', Arial, sans-serif;\n    line-height: 1.2;\n    max-width: 90%;\n    margin-left: auto;\n    margin-right: auto;\n  }\n\n  .language-onboarding-grid {\n    display: grid;\n    grid-template-columns: repeat(4, 1fr);\n    gap: clamp(0.2rem, 0.5vw, 0.3rem);\n    margin-bottom: clamp(0.3rem, 0.8vw, 0.5rem);\n    max-width: 100%;\n    margin-left: auto;\n    margin-right: auto;\n    padding: clamp(0.1rem, 0.4vw, 0.2rem);\n    box-sizing: border-box;\n    align-items: stretch;\n    height: auto;\n    justify-items: center;\n    max-height: 50vh;\n    overflow: hidden;\n  }\n\n  .language-onboarding-card {\n    padding: clamp(0.1rem, 0.3vw, 0.2rem);\n    border-radius: clamp(0.1rem, 0.4vw, 0.2rem);\n    border: 1px solid rgba(126,90,117,0.2);\n    background-color: var(--cream);\n    cursor: pointer;\n    transition: all 0.3s ease;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    box-sizing: border-box;\n    width: 100%;\n    max-width: 90px;\n    margin: 0 auto;\n    min-height: 0;\n    height: calc((50vh - 1.5rem) / 6);\n    max-height: calc((50vh - 1.5rem) / 6);\n  }\n\n  .language-onboarding-card:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(126,90,117,0.15);\n  }\n\n  .language-onboarding-card.selected {\n    border-color: var(--rose-primary);\n    background-color: rgba(126,90,117,0.1);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(126,90,117,0.2);\n  }\n\n  .language-onboarding-flag {\n    font-size: clamp(0.7rem, 1.4vw, 0.9rem);\n    margin-bottom: clamp(0.02rem, 0.05vw, 0.03rem);\n    line-height: 1;\n  }\n\n  .language-onboarding-name {\n    font-weight: 600;\n    color: var(--blue-secondary);\n    margin-bottom: clamp(0.02rem, 0.05vw, 0.03rem);\n    font-size: clamp(0.45rem, 0.9vw, 0.55rem);\n    font-family: 'Gabriela', Arial, sans-serif;\n    line-height: 1;\n  }\n\n  .language-onboarding-description {\n    font-size: clamp(0.35rem, 0.7vw, 0.45rem);\n    color: var(--rose-primary);\n    line-height: 1;\n    font-family: 'AR One Sans', Arial, sans-serif;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 1;\n    -webkit-box-orient: vertical;\n    word-wrap: break-word;\n    hyphens: auto;\n    text-align: center;\n    flex-grow: 1;\n  }\n\n  /* Mobile-first responsive breakpoints */\n  @media (max-width: 480px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(2, 1fr);\n      gap: clamp(0.15rem, 0.4vw, 0.25rem);\n      padding: clamp(0.1rem, 0.3vw, 0.15rem);\n    }\n    \n    .language-onboarding-card {\n      padding: clamp(0.08rem, 0.25vw, 0.15rem);\n      max-width: 85px;\n      height: calc((50vh - 1rem) / 11);\n      max-height: calc((50vh - 1rem) / 11);\n    }\n    \n    .language-onboarding-flag {\n      font-size: clamp(0.6rem, 1.2vw, 0.8rem);\n      margin-bottom: clamp(0.01rem, 0.03vw, 0.02rem);\n    }\n    \n    .language-onboarding-name {\n      font-size: clamp(0.4rem, 0.8vw, 0.5rem);\n      margin-bottom: clamp(0.01rem, 0.03vw, 0.02rem);\n    }\n    \n    .language-onboarding-description {\n      font-size: clamp(0.3rem, 0.6vw, 0.4rem);\n      -webkit-line-clamp: 1;\n    }\n  }\n\n  @media (min-width: 481px) and (max-width: 768px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(3, 1fr);\n      gap: 0.4rem;\n    }\n    \n    .language-onboarding-card {\n      max-width: 100px;\n    }\n    \n    .language-onboarding-flag {\n      font-size: 1.1rem;\n    }\n    \n    .language-onboarding-name {\n      font-size: 0.65rem;\n    }\n    \n    .language-onboarding-description {\n      font-size: 0.5rem;\n    }\n  }\n\n  @media (min-width: 769px) and (max-width: 1024px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n      gap: 0.7rem;\n    }\n    \n    .language-onboarding-card {\n      max-width: 170px;\n    }\n    \n    .language-onboarding-flag {\n      font-size: 1.5rem;\n    }\n    \n    .language-onboarding-name {\n      font-size: 0.8rem;\n    }\n    \n    .language-onboarding-description {\n      font-size: 0.6rem;\n    }\n  }\n\n  @media (min-width: 1025px) and (max-width: 1439px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(4, 1fr) !important;\n      gap: clamp(0.2rem, 0.5vw, 0.4rem);\n    }\n    \n    .language-onboarding-card {\n      max-width: 90px;\n      height: calc((50vh - 1.5rem) / 6);\n      max-height: calc((50vh - 1.5rem) / 6);\n    }\n    \n    .language-onboarding-flag {\n      font-size: clamp(0.7rem, 1.4vw, 0.9rem);\n    }\n    \n    .language-onboarding-name {\n      font-size: clamp(0.45rem, 0.9vw, 0.55rem);\n    }\n    \n    .language-onboarding-description {\n      font-size: clamp(0.35rem, 0.7vw, 0.45rem);\n    }\n  }\n\n  /* Large screens optimization */\n  @media (min-width: 1440px) and (max-width: 1919px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(4, 1fr) !important;\n      gap: clamp(0.2rem, 0.5vw, 0.4rem);\n      max-width: 100%;\n    }\n    \n    .language-onboarding-card {\n      max-width: 90px;\n      height: calc((50vh - 1.5rem) / 6);\n      max-height: calc((50vh - 1.5rem) / 6);\n    }\n    \n    .language-onboarding-flag {\n      font-size: clamp(0.7rem, 1.4vw, 0.9rem);\n    }\n    \n    .language-onboarding-name {\n      font-size: clamp(0.45rem, 0.9vw, 0.55rem);\n    }\n    \n    .language-onboarding-description {\n      font-size: clamp(0.35rem, 0.7vw, 0.45rem);\n    }\n  }\n\n  /* Ultra-wide screens */\n  @media (min-width: 1920px) {\n    .language-onboarding-grid {\n      grid-template-columns: repeat(4, 1fr) !important;\n      gap: clamp(0.2rem, 0.5vw, 0.4rem);\n      max-width: 100%;\n    }\n    \n    .language-onboarding-card {\n      max-width: 90px;\n      height: calc((50vh - 1.5rem) / 6);\n      max-height: calc((50vh - 1.5rem) / 6);\n    }\n    \n    .language-onboarding-flag {\n      font-size: clamp(0.7rem, 1.4vw, 0.9rem);\n    }\n    \n    .language-onboarding-name {\n      font-size: clamp(0.45rem, 0.9vw, 0.55rem);\n    }\n    \n    .language-onboarding-description {\n      font-size: clamp(0.35rem, 0.7vw, 0.45rem);\n    }\n  }\n"}}),(0,n.jsx)("div",{style:{height:"calc(100vh - 6rem)",background:"linear-gradient(135deg, var(--cream) 0%, #e8e0d8 50%, #d4c8c0 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5vh",fontFamily:"Montserrat, Arial, sans-serif",overflow:"hidden"},children:(0,n.jsxs)("div",{style:{background:"#fff",borderRadius:"1.5vh",padding:"2vh",boxShadow:"0 2vh 6vh rgba(60,76,115,0.15)",maxWidth:"55vw",width:"100%",height:"calc(100vh - 6rem - 1vh)",display:"flex",flexDirection:"column",position:"relative",overflow:"hidden"},children:[(0,n.jsxs)("div",{style:{textAlign:"center",marginBottom:"0.2vh",flexShrink:0,height:"6vh"},children:[(0,n.jsx)("div",{style:{fontSize:"2.0vh",marginBottom:"0.1vh"},children:"\uD83C\uDF0D"}),(0,n.jsx)("h1",{style:{color:"var(--blue-secondary)",fontSize:"3.5vh",fontWeight:700,marginBottom:"0.1vh",fontFamily:"Gabriela, Arial, sans-serif"},children:"Add New Language"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",fontSize:"1.8vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:"Expand your multilingual journey"})]}),(0,n.jsx)("div",{style:{marginTop:"3.5vh",marginBottom:"0.4vh",flexShrink:0,height:"2vh"},children:(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,n.jsxs)("span",{style:{color:"var(--rose-primary)",fontSize:"0.9rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif"},children:["Step ",d," of ",4]}),(0,n.jsxs)("span",{style:{color:"var(--rose-primary)",fontSize:"0.9rem",fontFamily:"Montserrat, Arial, sans-serif"},children:[Math.round(d/4*100),"% Complete"]})]}),(0,n.jsx)("div",{style:{width:"100%",height:"6px",backgroundColor:"rgba(126,90,117,0.2)",borderRadius:"3px",overflow:"hidden"},children:(0,n.jsx)("div",{style:{width:"".concat(d/4*100,"%"),height:"100%",backgroundColor:"var(--rose-primary)",borderRadius:"3px",transition:"width 0.3s ease"}})})]})}),h&&(0,n.jsx)("div",{style:{background:"rgba(220,53,69,0.1)",color:"#dc3545",padding:"0.6vh",borderRadius:"0.6vh",marginTop:"2.4vh",marginBottom:"0.4vh",border:"1px solid rgba(220,53,69,0.2)",textAlign:"center",fontFamily:"Montserrat, Arial, sans-serif",fontSize:"1.4vh",flexShrink:0,height:"3vh"},children:h}),(0,n.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",marginBottom:"0.2vh",minHeight:0,overflow:"hidden",maxWidth:"80%",margin:"0 auto"},children:(()=>{switch(d){case 1:return(0,n.jsxs)("div",{className:"language-onboarding-step-container",children:[(0,n.jsx)("h2",{className:"language-onboarding-title",children:"Which language would you like to add?"}),(0,n.jsx)("p",{className:"language-onboarding-subtitle",children:"Choose another language you want to practice speaking with AI feedback"}),0===b.length?(0,n.jsxs)("div",{style:{textAlign:"center",color:"var(--rose-primary)",marginBottom:"2rem",fontFamily:"AR One Sans, Arial, sans-serif"},children:[(0,n.jsx)("p",{children:"You already have dashboards for all available languages!"}),(0,n.jsx)("p",{children:"You can edit your existing language settings from the dashboard."})]}):(0,n.jsx)("div",{className:"language-onboarding-grid",children:b.map(e=>(0,n.jsxs)("div",{onClick:()=>x("language",e.code),className:"language-onboarding-card ".concat(p.language===e.code?"selected":""),children:[(0,n.jsx)("div",{className:"language-onboarding-flag",children:e.flag}),(0,n.jsx)("div",{className:"language-onboarding-name",children:e.label}),(0,n.jsx)("div",{className:"language-onboarding-description",children:e.description})]},e.code))}),(0,n.jsxs)("div",{style:{marginTop:"1.2vh",marginBottom:"0.5vh"},children:[(0,n.jsx)("h3",{style:{color:"var(--blue-secondary)",fontSize:"1.8vh",fontWeight:600,marginBottom:"0.3vh",fontFamily:"Gabriela, Arial, sans-serif"},children:"Feedback Language"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",fontSize:"1.4vh",marginBottom:"0.4vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:"Choose the language in which you want to receive AI feedback and explanations."}),(0,n.jsx)("select",{value:p.feedbackLanguage,onChange:e=>f(r=>({...r,feedbackLanguage:e.target.value})),style:{width:"100%",padding:"0.6vh",borderRadius:"0.6vh",border:"2px solid var(--rose-accent)",fontSize:"1.4vh",background:"var(--cream)",color:"var(--blue-secondary)",fontFamily:"Montserrat, Arial, sans-serif"},children:c.ww.map(e=>(0,n.jsx)("option",{value:e.code,children:e.label},e.code))})]})]});case 2:return(0,n.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,n.jsx)("h2",{style:{color:"var(--blue-secondary)",fontSize:"2.6vh",fontWeight:700,marginBottom:"0.6vh",textAlign:"center",fontFamily:"Gabriela, Arial, sans-serif"},children:"What's your current level?"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",textAlign:"center",marginBottom:"1.2vh",fontSize:"1.7vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:"Be honest - this helps us personalize your experience"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1.0vh",marginBottom:"0.4vh"},children:c.eo.map(e=>(0,n.jsxs)("div",{onClick:()=>x("proficiency",e.level),style:{padding:"1.2vh",borderRadius:"0.8vh",border:"2px solid ".concat(p.proficiency===e.level?"var(--rose-primary)":"rgba(126,90,117,0.2)"),backgroundColor:p.proficiency===e.level?"rgba(126,90,117,0.1)":"var(--cream)",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.8vh",minHeight:"8vh"},children:[(0,n.jsx)("div",{style:{fontSize:"2.5vh"},children:e.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--blue-secondary)",marginBottom:"0.2vh",fontSize:"1.6vh",fontFamily:"Gabriela, Arial, sans-serif"},children:e.label}),(0,n.jsx)("div",{style:{fontSize:"1.3vh",color:"var(--rose-primary)",fontFamily:"AR One Sans, Arial, sans-serif"},children:e.description})]})]},e.level))})]});case 3:return(0,n.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},children:[(0,n.jsx)("h2",{style:{color:"var(--blue-secondary)",fontSize:"2.2vh",fontWeight:700,marginBottom:"0.2vh",textAlign:"center",fontFamily:"Gabriela, Arial, sans-serif"},children:"What would you like to focus on?"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",textAlign:"center",marginBottom:"0.4vh",fontSize:"1.2vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:"Choose topics you'd like to discuss and skills you want to develop"}),(0,n.jsxs)("div",{style:{marginBottom:"0.8vh"},children:[(0,n.jsx)("h3",{style:{color:"var(--blue-secondary)",fontSize:"1.8vh",fontWeight:600,marginBottom:"0.2vh",display:"flex",alignItems:"center",gap:"0.3vh",fontFamily:"Gabriela, Arial, sans-serif"},children:"\uD83D\uDCAC Topics I'd like to talk about"}),(0,n.jsx)("div",{className:"topics-grid",children:c.O_.map(e=>(0,n.jsxs)("div",{onClick:()=>{var r;return r=e.id,void f(e=>({...e,talkTopics:e.talkTopics.includes(r)?e.talkTopics.filter(e=>e!==r):[...e.talkTopics,r]}))},style:{padding:"0.7vh",borderRadius:"0.4vh",border:"2px solid ".concat(p.talkTopics.includes(e.id)?"var(--rose-primary)":"rgba(126,90,117,0.2)"),backgroundColor:p.talkTopics.includes(e.id)?"rgba(126,90,117,0.1)":"var(--cream)",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",marginTop:"0.2vh",marginLeft:"0.3vh",marginRight:"0.3vh",marginBottom:"0.2vh",gap:"1.3vh"},children:[(0,n.jsx)("div",{style:{fontSize:"1.4vh"},children:e.icon}),(0,n.jsx)("div",{style:{fontWeight:500,color:"var(--blue-secondary)",fontSize:"1.5vh",fontFamily:"Gabriela, Arial, sans-serif"},children:e.label})]},e.id))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{style:{color:"var(--blue-secondary)",fontSize:"1.8vh",fontWeight:600,marginBottom:"0.2vh",display:"flex",alignItems:"center",gap:"0.3vh",fontFamily:"Gabriela, Arial, sans-serif"},children:"\uD83C\uDFAF Skills I want to develop"}),(0,n.jsx)("div",{className:"goals-grid",children:c.Kq.map(e=>(0,n.jsxs)("div",{onClick:()=>{var r;return r=e.id,void f(e=>({...e,learningGoals:e.learningGoals.includes(r)?e.learningGoals.filter(e=>e!==r):[...e.learningGoals,r]}))},style:{padding:"0.5vh",borderRadius:"0.4vh",border:"2px solid ".concat(p.learningGoals.includes(e.id)?"var(--rose-primary)":"rgba(126,90,117,0.2)"),backgroundColor:p.learningGoals.includes(e.id)?"rgba(126,90,117,0.1)":"var(--cream)",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.3vh",marginTop:"0.2vh",marginLeft:"0.3vh",marginRight:"0.3vh",marginBottom:"0.2vh"},children:[(0,n.jsx)("div",{style:{fontSize:"1.8vh"},children:e.icon}),(0,n.jsx)("div",{style:{fontWeight:500,color:"var(--blue-secondary)",fontSize:"1.5vh",fontFamily:"Gabriela, Arial, sans-serif"},children:e.goal})]},e.id))})]})]});case 4:return(0,n.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,n.jsx)("h2",{style:{color:"var(--blue-secondary)",fontSize:"2.2vh",fontWeight:700,marginBottom:"0.3vh",textAlign:"center",fontFamily:"Gabriela, Arial, sans-serif"},children:"How do you prefer to practice?"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",textAlign:"center",marginBottom:"0.8vh",fontSize:"1.4vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:"Choose what works best for your schedule"}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.6vh",marginBottom:"0.2vh"},children:c.l_.map(e=>(0,n.jsxs)("div",{onClick:()=>x("practicePreference",e.id),style:{padding:"1.2vh",borderRadius:"0.8vh",border:"2px solid ".concat(p.practicePreference===e.id?"var(--rose-primary)":"rgba(126,90,117,0.2)"),backgroundColor:p.practicePreference===e.id?"rgba(126,90,117,0.1)":"var(--cream)",cursor:"pointer",transition:"all 0.3s ease"},children:[(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--blue-secondary)",marginBottom:"0.1vh",fontSize:"1.8vh",fontFamily:"Gabriela, Arial, sans-serif"},children:e.label}),(0,n.jsx)("div",{style:{fontSize:"1.3vh",color:"var(--rose-primary)",fontFamily:"AR One Sans, Arial, sans-serif"},children:e.description})]},e.id))}),(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.1)",padding:"1.5vh",borderRadius:"1.2vh",textAlign:"center",marginTop:"0.8vh"},children:[(0,n.jsx)("div",{style:{fontSize:"3vh",marginBottom:"0.3vh"},children:"\uD83C\uDF89"}),(0,n.jsx)("h3",{style:{color:"var(--blue-secondary)",marginBottom:"0.3vh",fontSize:"2vh",fontFamily:"Gabriela, Arial, sans-serif"},children:"You're all set!"}),(0,n.jsx)("p",{style:{color:"var(--rose-primary)",fontSize:"1.4vh",fontFamily:"AR One Sans, Arial, sans-serif"},children:'Click "Complete Setup" to access your personalized dashboard and start your first practice session.'})]})]});default:return(0,n.jsx)("div",{children:"Invalid step"})}})()}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0,paddingTop:"0.2vh",borderTop:"1px solid rgba(126,90,117,0.1)",height:"4vh",minHeight:"4vh"},children:[(0,n.jsx)("button",{onClick:()=>{d>1&&(m(e=>e-1),u(""))},disabled:1===d,style:{padding:"0.6vh 1.5vh",borderRadius:"0.8vh",border:"2px solid rgba(126,90,117,0.3)",background:"transparent",color:1===d?"#ccc":"var(--rose-primary)",fontSize:"1.4vh",fontWeight:600,cursor:1===d?"not-allowed":"pointer",transition:"all 0.3s ease",opacity:1===d?.5:1,fontFamily:"Montserrat, Arial, sans-serif"},children:"← Back"}),d<4?(0,n.jsx)("button",{onClick:()=>{if(!j())return void u(S());d<4&&(m(e=>e+1),u(""))},disabled:0===b.length,style:{padding:"0.6vh 2vh",borderRadius:"0.8vh",border:"none",background:0===b.length?"#ccc":"linear-gradient(135deg, var(--rose-primary) 0%, #8a6a7a 100%)",color:"#fff",fontSize:"1.4vh",fontWeight:600,cursor:0===b.length?"not-allowed":"pointer",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif"},children:"Next →"}):(0,n.jsx)("button",{onClick:w,disabled:y,style:{padding:"0.6vh 2vh",borderRadius:10,border:"none",background:y?"#ccc":"linear-gradient(135deg, var(--rose-accent) 0%, var(--rose-primary) 100%)",color:"#fff",fontSize:"1rem",fontWeight:600,cursor:y?"not-allowed":"pointer",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif"},children:y?"Creating...":"\uD83C\uDF89 Complete Setup"})]})]})})]})},p={hi:"Devanagari",ja:"Japanese",zh:"Chinese",ko:"Korean",ar:"Arabic",ta:"Tamil",ml:"Malayalam",or:"Odia"},f=e=>({es:{label:"Spanish",flag:"\uD83C\uDDEA\uD83C\uDDF8"},hi:{label:"Hindi",flag:"\uD83C\uDDEE\uD83C\uDDF3"},ja:{label:"Japanese",flag:"\uD83C\uDDEF\uD83C\uDDF5"},tl:{label:"Tagalog",flag:"\uD83C\uDDF5\uD83C\uDDED"},ta:{label:"Tamil",flag:"\uD83C\uDDEE\uD83C\uDDF3"},ar:{label:"Arabic",flag:"\uD83C\uDDF8\uD83C\uDDE6"},zh:{label:"Mandarin",flag:"\uD83C\uDDE8\uD83C\uDDF3"},ko:{label:"Korean",flag:"\uD83C\uDDF0\uD83C\uDDF7"}})[e]||{label:e,flag:"\uD83C\uDF0D"};function h(e){var r;let{dashboard:a,isOpen:o,onClose:t,onUpdate:l,onDelete:s}=e,[d,g]=(0,i.useState)(a),[m,h]=(0,i.useState)(!1),[u,y]=(0,i.useState)(!1),[v,b]=(0,i.useState)("");(0,i.useEffect)(()=>{a&&(console.log("[DEBUG] Dashboard data received:",a),console.log("[DEBUG] Is script language:",a.language in p),console.log("[DEBUG] Current romanization_display:",a.romanization_display),g({...a,talk_topics:a.talk_topics||[],learning_goals:a.learning_goals||[],speak_speed:a.speak_speed||1,romanization_display:a.language in p?a.romanization_display||"both":void 0}),console.log("[DEBUG] Edited dashboard initialized:",{...a,talk_topics:a.talk_topics||[],learning_goals:a.learning_goals||[],speak_speed:a.speak_speed||1,romanization_display:a.language in p?a.romanization_display||"both":void 0}))},[a]);let x=async()=>{h(!0),b("");try{localStorage.getItem("jwt");let e={proficiency_level:d.proficiency_level,talk_topics:d.talk_topics,learning_goals:d.learning_goals,speak_speed:d.speak_speed};a.language in p&&(e.romanization_display=d.romanization_display,console.log("[DEBUG] Saving romanization_display:",d.romanization_display)),console.log("[DEBUG] Saving dashboard data:",e),console.log("[DEBUG] Language:",a.language),console.log("[DEBUG] Is script language:",a.language in p),console.log("[DEBUG] Would save dashboard data:",e),l(d),t()}catch(e){console.error("[DEBUG] Save error:",e),b("Failed to update dashboard settings. Please try again.")}finally{h(!1)}},j=async()=>{let e="Are you sure you want to delete your ".concat(f(a.language).label," dashboard? This will permanently delete all conversations and messages in this language. This action cannot be undone.");if(window.confirm(e)){y(!0),b("");try{console.log("[DEBUG] Would delete dashboard for language:",a.language),s&&s(a.language),t()}catch(e){b("Failed to delete dashboard. Please try again.")}finally{y(!1)}}};return o?(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:(0,n.jsxs)("div",{style:{background:"#fff",borderRadius:20,padding:"1.5rem",boxShadow:"0 20px 60px rgba(60,76,115,0.25)",maxWidth:"min(1200px, 98vw)",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[(0,n.jsxs)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"⚙️"}),(0,n.jsx)("h2",{style:{color:"#3c4c73",fontSize:"1.5rem",fontWeight:700,marginBottom:"0.5rem"},className:"font-heading",children:"Dashboard Settings"}),(0,n.jsxs)("p",{style:{color:"#7e5a75",fontSize:"0.9rem",margin:0},className:"font-body",children:["Customize your ",f(a.language).label," learning experience"]})]}),v&&(0,n.jsx)("div",{style:{background:"rgba(220,53,69,0.1)",color:"#dc3545",padding:"0.75rem",borderRadius:8,marginBottom:"1.5rem",border:"1px solid rgba(220,53,69,0.2)",textAlign:"center"},children:v}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h3",{style:{color:"#3c4c73",fontSize:"1.1rem",fontWeight:600,marginBottom:"1rem"},className:"font-heading",children:"\uD83D\uDCCA Proficiency Level"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"0.5rem"},children:c.eo.map(e=>{var r;let a=d.proficiency_level===e.level,i={beginner:{label:"Beginner",icon:"\uD83C\uDF31"},elementary:{label:"Elementary",icon:"\uD83C\uDF3F"},intermediate:{label:"Intermediate",icon:"\uD83C\uDF33"},advanced:{label:"Advanced",icon:"\uD83C\uDFD4️"},fluent:{label:"Fluent",icon:"\uD83D\uDDDD️"}}[r=e.level]||{label:r,icon:"\uD83C\uDF31"};return(0,n.jsxs)("button",{onClick:()=>g(r=>({...r,proficiency_level:e.level})),style:{background:a?"#7e5a75":"rgba(126,90,117,0.1)",color:a?"#fff":"#3c4c73",border:"2px solid ".concat(a?"#7e5a75":"rgba(126,90,117,0.2)"),borderRadius:8,padding:"0.5rem 1rem",cursor:"pointer",transition:"all 0.3s ease",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("span",{children:i.icon}),i.label]},e.level)})})]}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h3",{style:{color:"#3c4c73",fontSize:"1.1rem",fontWeight:600,marginBottom:"1rem"},className:"font-heading",children:"\uD83D\uDCAC Conversation Topics"}),(0,n.jsx)("p",{style:{color:"#7e5a75",fontSize:"0.85rem",marginBottom:"1rem",lineHeight:1.4},className:"font-body",children:"Choose topics you'd like to practice. You can select multiple topics."}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"0.5rem"},children:c.O_.map(e=>{let r=d.talk_topics.includes(e.id);return(0,n.jsxs)("div",{onClick:()=>{var r;return r=e.id,void g(e=>({...e,talk_topics:e.talk_topics.includes(r)?e.talk_topics.filter(e=>e!==r):[...e.talk_topics,r]}))},style:{padding:"0.75rem",borderRadius:"8px",border:"2px solid ".concat(r?"#7e5a75":"rgba(126,90,117,0.2)"),backgroundColor:r?"rgba(126,90,117,0.1)":"#f8f6f4",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("div",{style:{fontSize:"1.2rem"},children:e.icon}),(0,n.jsx)("div",{style:{fontWeight:500,color:"#3c4c73",fontSize:"0.85rem",flex:1},className:"font-body",children:e.label}),r&&(0,n.jsx)("div",{style:{color:"#7e5a75",fontSize:"1rem"},children:"✓"})]},e.id)})})]}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h3",{style:{color:"#3c4c73",fontSize:"1.1rem",fontWeight:600,marginBottom:"1rem"},className:"font-heading",children:"\uD83C\uDFAF Learning Goals"}),(0,n.jsx)("p",{style:{color:"#7e5a75",fontSize:"0.85rem",marginBottom:"1rem",lineHeight:1.4},className:"font-body",children:"Choose your learning objectives. You can select multiple goals."}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.5rem"},children:c.Kq.map(e=>{let r=d.learning_goals.includes(e.id);return(0,n.jsxs)("div",{onClick:()=>{var r;return r=e.id,void g(e=>({...e,learning_goals:e.learning_goals.includes(r)?e.learning_goals.filter(e=>e!==r):[...e.learning_goals,r]}))},style:{padding:"0.75rem",borderRadius:"8px",border:"2px solid ".concat(r?"#7e5a75":"rgba(126,90,117,0.2)"),backgroundColor:r?"rgba(126,90,117,0.1)":"#f8f6f4",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("div",{style:{fontSize:"1.2rem"},children:e.icon}),(0,n.jsx)("div",{style:{fontWeight:500,color:"#3c4c73",fontSize:"0.85rem",flex:1},className:"font-body",children:e.goal}),r&&(0,n.jsx)("div",{style:{color:"#7e5a75",fontSize:"1rem"},children:"✓"})]},e.id)})})]}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h3",{style:{color:"#3c4c73",fontSize:"1.1rem",fontWeight:600,marginBottom:"1rem"},className:"font-heading",children:"\uD83C\uDFA4 Speak Speed"}),(0,n.jsx)("p",{style:{color:"#7e5a75",fontSize:"0.85rem",marginBottom:"1rem",lineHeight:1.4},className:"font-body",children:"Adjust how fast the AI speaks during conversations. Slower speeds are better for beginners."}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",background:"rgba(126,90,117,0.05)",borderRadius:12,border:"1px solid rgba(126,90,117,0.1)"},children:[(0,n.jsx)("span",{style:{color:"#7e5a75",fontSize:"0.9rem",fontWeight:600,minWidth:"60px"},children:"Slow"}),(0,n.jsx)("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:d.speak_speed||1,onChange:e=>g(r=>({...r,speak_speed:parseFloat(e.target.value)})),style:{flex:1,height:"8px",borderRadius:"4px",background:"linear-gradient(to right, #7e5a75 0%, #7e5a75 50%, #c38d94 100%)",outline:"none",cursor:"pointer",WebkitAppearance:"none",appearance:"none"}}),(0,n.jsx)("span",{style:{color:"#7e5a75",fontSize:"0.9rem",fontWeight:600,minWidth:"60px"},children:"Fast"}),(0,n.jsxs)("div",{style:{background:"#7e5a75",color:"#fff",padding:"0.3rem 0.75rem",borderRadius:6,fontSize:"0.8rem",fontWeight:600,minWidth:"50px",textAlign:"center"},children:[(null==(r=d.speak_speed)?void 0:r.toFixed(1))||"1.0","x"]})]})]}),a.language in p&&(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h3",{style:{color:"#3c4c73",fontSize:"1.1rem",fontWeight:600,marginBottom:"1rem"},className:"font-heading",children:"\uD83D\uDD24 Romanization Display"}),(0,n.jsxs)("p",{style:{color:"#7e5a75",fontSize:"0.85rem",marginBottom:"1rem",lineHeight:1.4},className:"font-body",children:["Choose how the AI displays romanized text for ",f(a.language).label,"."]}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"0.5rem"},children:["both","script_only","romanized_only"].map(e=>{let r=d.romanization_display===e;return(0,n.jsxs)("button",{onClick:()=>g(r=>({...r,romanization_display:e})),style:{padding:"0.75rem",borderRadius:"8px",border:"2px solid ".concat(r?"#7e5a75":"rgba(126,90,117,0.2)"),backgroundColor:r?"rgba(126,90,117,0.1)":"#f8f6f4",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("div",{style:{fontSize:"1.2rem"},children:"both"===e?"\uD83D\uDD24":"script_only"===e?"\uD83D\uDC41️":"\uD83D\uDC44"}),(0,n.jsx)("div",{style:{fontWeight:500,color:"#3c4c73",fontSize:"0.85rem",flex:1},className:"font-body",children:"both"===e?"Both Script and Romanized":"script_only"===e?"Only Script":"Only Romanized"}),r&&(0,n.jsx)("div",{style:{color:"#7e5a75",fontSize:"1rem"},children:"✓"})]},e)})})]}),(0,n.jsxs)("div",{style:{background:"rgba(220,53,69,0.1)",border:"1px solid rgba(220,53,69,0.2)",borderRadius:8,padding:"1rem",marginBottom:"1.5rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,n.jsx)("span",{style:{fontSize:"1.2rem"},children:"⚠️"}),(0,n.jsx)("div",{style:{color:"#dc3545",fontWeight:600,fontSize:"0.9rem"},children:"Danger Zone"})]}),(0,n.jsxs)("p",{style:{color:"#dc3545",fontSize:"0.85rem",margin:0,lineHeight:1.4},className:"font-body",children:["Deleting this dashboard will permanently remove all conversations, messages, and settings for ",f(a.language).label,". This action cannot be undone."]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.5rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:()=>{t()},style:{padding:"0.75rem 1.2rem",borderRadius:10,border:"2px solid rgba(126,90,117,0.3)",background:"transparent",color:"#7e5a75",fontSize:"0.9rem",fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",whiteSpace:"nowrap"},children:"Cancel"}),(0,n.jsx)("button",{onClick:j,disabled:u||m,style:{padding:"0.75rem 1.2rem",borderRadius:10,border:"2px solid #dc3545",background:"transparent",color:"#dc3545",fontSize:"0.9rem",fontWeight:600,cursor:u||m?"not-allowed":"pointer",transition:"all 0.3s ease",opacity:u||m?.5:1,whiteSpace:"nowrap"},children:u?"\uD83D\uDDD1️ Deleting...":"\uD83D\uDDD1️ Delete"})]}),(0,n.jsx)("button",{onClick:x,disabled:m||u,style:{padding:"0.75rem 1.2rem",borderRadius:10,border:"none",background:m||u?"#ccc":"linear-gradient(135deg, #7e5a75 0%, #8a6a7a 100%)",color:"#fff",fontSize:"0.9rem",fontWeight:600,cursor:m||u?"not-allowed":"pointer",transition:"all 0.3s ease",whiteSpace:"nowrap"},children:m?"\uD83D\uDCBE Saving...":"\uD83D\uDCBE Save Changes"})]})]})}):null}var u=a(9010),y=a(5704);function v(e){let{goal:r,index:a,progressData:o,userSubgoalProgress:t}=e,[l,s]=(0,i.useState)(!1);return console.log("LearningGoalCard received progressData:",o),console.log("LearningGoalCard goal:",r),console.log("LearningGoalCard index:",a),(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.05)",borderRadius:12,border:"1px solid rgba(126,90,117,0.1)",overflow:"hidden",transition:"all 0.3s ease"},children:[(0,n.jsxs)("div",{onClick:()=>s(!l),style:{padding:"0.75rem",display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(126,90,117,0.08)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,n.jsx)("div",{style:{background:"var(--rose-primary)",color:"#fff",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:600,flexShrink:0,fontFamily:"Montserrat, Arial, sans-serif"},children:a+1}),(0,n.jsx)("div",{style:{fontSize:"1.2rem",marginRight:"0.5rem"},children:r.icon}),(0,n.jsx)("div",{style:{color:"var(--foreground)",fontWeight:600,fontSize:"0.9rem",lineHeight:"1.3",fontFamily:"Gabriela, Arial, sans-serif",flex:1},children:r.goal}),(0,n.jsx)("div",{style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease",fontSize:"1rem",color:"var(--rose-primary)",fontWeight:600},children:"▼"})]}),l&&(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.02)",borderTop:"1px solid rgba(126,90,117,0.1)",padding:"0.75rem",opacity:1,maxHeight:"500px",transition:"all 0.3s ease-out"},children:[(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.8rem",fontWeight:600,marginBottom:"0.5rem",fontFamily:"Montserrat, Arial, sans-serif"},children:"Progress Indicators:"}),r.subgoals&&r.subgoals.length>0?(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.subgoals.map((e,r)=>{let a=(0,c.ex)(e.id,t||[]),i=(0,c.v0)(e.id,t||[]);console.log("LearningGoalCard subgoal ".concat(e.id,":"),{userLevel:a,userProgress:i,userSubgoalProgress:t||[]});let o=100===i?0:i;console.log("Subgoal ".concat(e.id," display logic:"),{userLevel:a,userProgress:i,displayLevel:a,displayProgress:o,isLevelUp:100===i});let l=(0,c.f6)(e.id,a);return console.log("Subgoal ".concat(e.id,":"),{userLevel:a,userProgress:i,currentDescription:l,userSubgoalProgress:t||[]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.5rem",background:"var(--card)",borderRadius:8,border:"1px solid rgba(126,90,117,0.1)"},children:[(0,n.jsx)("div",{style:{background:"var(--rose-accent)",color:"#fff",borderRadius:"50%",width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.6rem",fontWeight:600,flexShrink:0,fontFamily:"Montserrat, Arial, sans-serif",marginTop:"0.1rem"},children:r+1}),(0,n.jsxs)("div",{style:{color:"var(--foreground)",fontSize:"0.75rem",lineHeight:"1.4",fontFamily:"AR One Sans, Arial, sans-serif",flex:1},children:[l,(0,n.jsxs)("div",{style:{color:"var(--rose-accent)",fontSize:"0.65rem",fontStyle:"italic",marginTop:"0.25rem"},children:["Level ",a+1]})]}),(0,n.jsx)("div",{style:{width:"60px",height:"6px",background:"rgba(126,90,117,0.1)",borderRadius:3,marginTop:"0.2rem",position:"relative",overflow:"hidden"},children:(0,n.jsx)("div",{style:{width:"".concat(o,"%"),height:"100%",background:o>=80?"#10b981":o>=60?"#f59e0b":"var(--rose-primary)",borderRadius:3,transition:"width 0.3s ease"}})}),(0,n.jsxs)("div",{style:{color:"var(--foreground)",fontSize:"0.7rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif",marginLeft:"0.5rem",minWidth:"30px",textAlign:"right"},children:[o,"%"]})]},e.id)})}):(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.75rem",fontStyle:"italic",textAlign:"center",padding:"1rem",fontFamily:"AR One Sans, Arial, sans-serif"},children:"No progress indicators available for this goal yet."})]})]})}function b(){var e,r,a;let t=(0,s.useRouter)(),{user:p}=(0,o.J)(),[f,b]=(0,i.useState)([]);if((0,i.useEffect)(()=>{if(y.env.NEXT_PUBLIC_BYPASS_AUTH,null===p)return void t.push("/login")},[p,t]),null===p&&(y.env.NEXT_PUBLIC_BYPASS_AUTH,1))return(0,n.jsx)(u.A,{message:"Checking authentication..."});let[x,j]=(0,i.useState)(null),[S,w]=(0,i.useState)([]),[k,A]=(0,i.useState)([]),[z,_]=(0,i.useState)(!0),[C,D]=(0,i.useState)(""),[F,R]=(0,i.useState)(!1),[N,B]=(0,i.useState)(!1),[W,I]=(0,i.useState)(new Set),[T,E]=(0,i.useState)([]);i.useEffect(()=>{x&&localStorage.setItem("selectedLanguage",x)},[x]);let G=(0,i.useCallback)(async()=>{_(!0),D("");try{if(!(null==p?void 0:p.id))throw Error("User not authenticated");let{success:e,data:r}=await (0,g.p5)(p.id);if(!e)throw Error("Failed to fetch dashboards");let a=(r||[]).map(e=>({...e,talk_topics:e.talk_topics||[],learning_goals:e.learning_goals||[],speak_speed:e.speak_speed||1,romanization_display:e.romanization_display||"both"}));b(a);let n=localStorage.getItem("selectedLanguage"),i=x;!i&&(n&&a.some(e=>e.language===n)?i=n:a.length>0&&(i=a[0].language)),i&&i!==x&&j(i)}catch(e){console.error("Dashboard fetch error:",e),D("Failed to load dashboard data.")}finally{_(!1)}},[p,x]),L=(0,i.useCallback)(()=>{if((null==p?void 0:p.id)&&x){let e=localStorage.getItem("subgoal_progress_".concat(p.id,"_").concat(x));if(e)try{let r=JSON.parse(e);E(r),console.log("Loaded userSubgoalProgress from localStorage:",r)}catch(e){console.error("Error parsing stored subgoal progress:",e),E([])}else console.log("No stored subgoal progress found in localStorage"),E([])}},[null==p?void 0:p.id,x]);(0,i.useEffect)(()=>{(null==p?void 0:p.id)&&(G(),L())},[p,x,G,L]),(0,i.useEffect)(()=>{let e=()=>{if(p&&x){console.log("Storage changed, refreshing dashboard..."),G();let e=localStorage.getItem("subgoal_progress_".concat(p.id,"_").concat(x));if(e)try{let r=JSON.parse(e);E(r),console.log("Reloaded userSubgoalProgress from localStorage:",r)}catch(e){console.error("Error parsing stored subgoal progress:",e),E([])}else console.log("No stored progress found, clearing userSubgoalProgress"),E([])}};return window.addEventListener("subgoalProgressUpdated",e),()=>{window.removeEventListener("subgoalProgressUpdated",e)}},[p,x,G]);let O=(0,i.useCallback)(async()=>{if(x&&(null==p?void 0:p.id))try{if(w([]),!(null==p?void 0:p.id))return;let{success:e,data:r}=await (0,g.cL)(p.id);if(!e)throw Error("Failed to fetch conversations");(r||[]).filter(e=>{var r;return(null==(r=e.language_dashboards)?void 0:r.language)===x});let a=(r||[]).sort((e,r)=>new Date(r.created_at).getTime()-new Date(e.created_at).getTime());console.log("Fetched conversations with data:",a.map(e=>({id:e.id,title:e.title,synopsis:e.synopsis?e.synopsis.substring(0,100)+"...":"No synopsis",progress_data:e.progress_data,created_at:e.created_at}))),w(a)}catch(e){w([])}},[x,null==p?void 0:p.id]);(0,i.useEffect)(()=>{O()},[O]),(0,i.useEffect)(()=>{let e=()=>{x&&(null==p?void 0:p.id)&&(console.log("Dashboard focused, refetching conversations..."),O())};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[x,null==p?void 0:p.id,O]),(0,i.useEffect)(()=>{!async function(){if(null==p?void 0:p.id)try{let{success:e,data:r}=await (0,g.d8)(p.id);if(!e)throw Error("Failed to fetch personas");A(r||[])}catch(e){A([])}}()},[null==p?void 0:p.id]);let M=async e=>{if(window.confirm("Are you sure you want to delete this conversation? This action cannot be undone."))try{w(r=>r.filter(r=>r.id!==e))}catch(e){alert("Failed to delete conversation. Please try again.")}},P=async e=>{if(window.confirm("Are you sure you want to delete this persona? This action cannot be undone."))try{A(r=>r.filter(r=>r.id!==e))}catch(e){alert("Failed to delete persona. Please try again.")}},U=f.find(e=>e.language===x);U&&(U.talk_topics=U.talk_topics||[],U.learning_goals=U.learning_goals||[],U.romanization_display=U.romanization_display||"both");let[H,Y]=(0,i.useState)(0);(0,i.useEffect)(()=>{!async function(){if((null==p?void 0:p.id)&&x)try{Y(0)}catch(e){Y(0)}}()},[null==p?void 0:p.id,x]);let J=e=>{let r=c.Yj.find(r=>r.code===e);return r?{label:r.label,flag:r.flag}:{label:e,flag:"\uD83C\uDF0D"}},K=e=>({beginner:{label:"Beginner",icon:"\uD83C\uDF31"},elementary:{label:"Elementary",icon:"\uD83C\uDF3F"},intermediate:{label:"Intermediate",icon:"\uD83C\uDF33"},advanced:{label:"Advanced",icon:"\uD83C\uDFD4️"},fluent:{label:"Fluent",icon:"\uD83D\uDDDD️"}})[e]||{label:e,icon:"\uD83C\uDF31"};class q{static getCurrentLevel(e,r){let a=r.find(r=>r.subgoalId===e);return a?a.level:0}static getHistoricalLevel(e,r,a){let n=this.getCurrentLevel(e,a),i=0;if(r.progress_data)try{let a="string"==typeof r.progress_data?JSON.parse(r.progress_data):r.progress_data;if(a.percentages&&Array.isArray(a.percentages)){let n=this.getSubgoalIndex(e,r);n<a.percentages.length&&(i=a.percentages[n])}}catch(e){console.error("Error parsing conversation progress data:",e)}return{level:100===i?Math.max(0,n-1):n,percentage:i}}static getSubgoalIndex(e,r){if(!r.learning_goals)return 0;let a="string"==typeof r.learning_goals?JSON.parse(r.learning_goals):r.learning_goals,n=0;for(let r of a){let a=c.Kq.find(e=>e.id===r);if(null==a?void 0:a.subgoals){for(let r of a.subgoals)if(r.description){if(r.id===e)return n;n++}}}return 0}static formatLevelDisplay(e,r,a){let n=e+1;return"learning-goals"===r?"Level ".concat(n):100===a?"Level ".concat(n," → Level ").concat(n+1):"Level ".concat(n)}}let X=(e,r,a)=>{if(!e||!r.learning_goals)return{type:"plain",content:e};try{let n="string"==typeof r.learning_goals?JSON.parse(r.learning_goals):r.learning_goals;if(!Array.isArray(n)||0===n.length)return{type:"plain",content:e};let i=[];n.forEach(e=>{let n=c.Kq.find(r=>r.id===e);(null==n?void 0:n.subgoals)&&n.subgoals.forEach(e=>{if(e.description){let{level:n,percentage:o}=q.getHistoricalLevel(e.id,r,a),t=(0,c.f6)(e.id,n);i.push({description:t,subgoalId:e.id,percentage:o,level:n})}})});let o=e.split("\n"),t=[],l="",s="",d=0,g=0;for(let e of o){let r=e.trim();if(!r)continue;let a=r.match(/^(\d+):\s*(.*)/);if(a){s&&l&&t.push({title:s,content:l.trim(),percentage:d,level:g});let e=parseInt(a[1])-1;e<i.length?(s=i[e].description,d=i[e].percentage,g=i[e].level):(s="Subgoal ".concat(a[1]),d=0,g=0),l=a[2]||""}else l+=(l?"\n":"")+r}return s&&l&&t.push({title:s,content:l.trim(),percentage:d,level:g}),{type:"structured",evaluations:t}}catch(r){return console.error("Error processing recent conversations:",r),{type:"plain",content:e}}};return F?(0,n.jsx)(m,{onComplete:e=>{let r={...e,talk_topics:e.talk_topics||[],learning_goals:e.learning_goals||[],speak_speed:e.speak_speed||1,romanization_display:e.romanization_display||"both"};b(e=>[...e,r]),R(!1),j(e.language),localStorage.setItem("selectedLanguage",e.language)},existingLanguages:(f||[]).map(e=>e.language)}):(0,n.jsxs)("div",{className:"min-h-screen bg-cream",children:[(0,n.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[(0,n.jsxs)(d.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,n.jsxs)("h1",{className:"text-4xl font-heading font-bold text-rose-primary mb-2",children:["Welcome back, ",null==p||null==(e=p.name)?void 0:e.split(" ")[0],"!"]}),(0,n.jsx)("p",{className:"text-rose-accent font-body",children:"Your multilingual journey dashboard"})]}),(0,n.jsxs)(d.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-lg p-8 mb-8 border border-gray-200",children:[(0,n.jsx)("h3",{className:"text-2xl font-heading font-semibold text-rose-primary mb-4",children:"\uD83D\uDCDA Your Language Dashboards"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(f||[]).map(e=>{let r=J(e.language),a=K(e.proficiency_level),i=x===e.language;return(0,n.jsxs)("button",{onClick:()=>j(e.language),style:{display:"flex",alignItems:"center",gap:"1.5rem",padding:"2rem 2.5rem",borderRadius:"0.5rem",fontWeight:600,transition:"all 0.3s ease",background:i?"var(--rose-primary)":"var(--cream)",color:i?"#fff":"var(--rose-primary)",border:"2px solid ".concat(i?"var(--rose-accent)":"transparent"),boxShadow:i?"0 4px 15px rgba(126,90,117,0.3)":"none"},children:[(0,n.jsx)("span",{className:"text-2xl",children:r.flag}),(0,n.jsxs)("div",{style:{textAlign:"left"},children:[(0,n.jsx)("div",{style:{color:i?"#fff":"var(--rose-primary)",fontFamily:"Gabriela, Arial, sans-serif",fontWeight:600},children:r.label}),(0,n.jsxs)("div",{style:{color:i?"#fff":"var(--rose-accent)",fontSize:"0.875rem",opacity:.8,fontFamily:"AR One Sans, Arial, sans-serif"},children:[a.icon," ",a.label]})]})]},e.language)}),(0,n.jsxs)("button",{onClick:()=>R(!0),style:{display:"flex",alignItems:"center",gap:"1.5rem",padding:"2rem 2.5rem",borderRadius:"0.5rem",fontWeight:600,transition:"all 0.3s ease",border:"2px dashed rgba(126,90,117,0.4)",color:"var(--rose-primary)",background:"transparent",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(126,90,117,0.05)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,n.jsx)("span",{style:{fontSize:"1.5rem"},children:"➕"}),"Add Language"]})]})]}),U&&U.language&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-lg p-8 mb-8 border border-gray-200",children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[(0,n.jsx)("span",{style:{fontSize:"2rem"},children:J(U.language).flag}),(0,n.jsx)("h2",{style:{color:"var(--blue-secondary)",fontSize:"1.5rem",fontWeight:700,margin:0,fontFamily:"Gabriela, Arial, sans-serif"},className:"font-heading",children:J(U.language).label}),(0,n.jsx)("span",{style:{background:"var(--rose-primary)",color:"#fff",padding:"0.3rem 0.75rem",borderRadius:6,fontSize:"0.8rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif"},children:K(U.proficiency_level).label})]}),(0,n.jsxs)("div",{style:{color:"var(--rose-primary)",fontSize:"0.9rem",fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:[(null==(r=U.talk_topics)?void 0:r.length)||0," topics • ",(null==(a=U.learning_goals)?void 0:a.length)||0," goals"]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,n.jsx)("button",{onClick:()=>B(!0),style:{background:"transparent",color:"var(--rose-primary)",border:"2px solid rgba(126,90,117,0.3)",borderRadius:8,padding:"0.5rem 1rem",cursor:"pointer",transition:"all 0.3s ease",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",fontFamily:"Montserrat, Arial, sans-serif"},children:"⚙️ Settings"}),(0,n.jsx)(l(),{href:"/analyze?language=".concat(U.language),style:{display:"inline-block",background:"linear-gradient(135deg, var(--rose-primary) 0%, #8a6a7a 100%)",color:"#fff",padding:"0.75rem 1.5rem",borderRadius:10,textDecoration:"none",fontWeight:600,fontSize:"1rem",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(126,90,117,0.3)",fontFamily:"Montserrat, Arial, sans-serif"},children:"\uD83C\uDFA4 Practice Now"})]})]})}),(0,n.jsxs)(d.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 text-center min-h-[140px] flex flex-col justify-center border border-gray-200",children:[(0,n.jsx)("div",{className:"text-3xl mb-3",children:"\uD83D\uDD25"}),(0,n.jsx)("div",{className:"text-3xl font-bold text-rose-accent mb-2 font-heading",children:H}),(0,n.jsx)("div",{className:"text-rose-primary text-sm font-body",children:"Day Streak"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 text-center min-h-[140px] flex flex-col justify-center border border-gray-200",children:[(0,n.jsx)("div",{className:"text-3xl mb-3",children:"\uD83D\uDCAC"}),(0,n.jsx)("div",{className:"text-3xl font-bold text-rose-primary mb-2 font-heading",children:(S||[]).length}),(0,n.jsx)("div",{className:"text-rose-primary text-sm font-base",children:"Conversations"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 min-h-[300px] border border-gray-200 md:col-span-2",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[(0,n.jsx)("div",{style:{fontSize:"1.5rem"},children:"\uD83C\uDFAF"}),(0,n.jsx)("div",{style:{color:"var(--blue-secondary)",fontSize:"1.1rem",fontWeight:600,fontFamily:"Gabriela, Arial, sans-serif"},children:"Learning Goals"})]}),U.learning_goals&&U.learning_goals.length>0?(0,n.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",scrollbarWidth:"thin",scrollbarColor:"var(--rose-accent) transparent"},children:(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:U.learning_goals.map((e,r)=>{let a,i=c.Kq.find(r=>r.id===e);if(!i)return null;if(console.log("=== PROGRESS DATA AGGREGATION DEBUG ==="),console.log("Goal ID:",e),console.log("Goal:",i),console.log("All conversations for progress aggregation:",S),S&&S.length>0){let r=[];if(S.forEach(a=>{if(console.log("Checking conversation:",a.id,"for progress_data"),a.progress_data)try{let n="string"==typeof a.progress_data?JSON.parse(a.progress_data):a.progress_data;if(n.goals&&n.percentages)console.log("Found new format progress data:",n),n.goals.includes(e)?(console.log("✅ Conversation practiced this goal, adding progress data"),r.push(n.percentages)):console.log("❌ Conversation did not practice this goal, skipping");else if(Array.isArray(n))if(console.log("Found old format progress data:",n),a.learning_goals)try{("string"==typeof a.learning_goals?JSON.parse(a.learning_goals):a.learning_goals).includes(e)?(console.log("✅ Conversation practiced this goal (old format), adding progress data"),r.push(n)):console.log("❌ Conversation did not practice this goal (old format), skipping")}catch(e){console.error("Error parsing conversation learning goals:",e)}else console.log("❌ No learning_goals found in conversation, skipping old format data");else console.log("❌ Progress data is not in expected format for conversation:",a.id)}catch(e){console.error("❌ Error parsing progress data from conversation:",a.id,e)}else console.log("❌ No progress_data found in conversation:",a.id)}),console.log("Relevant progress data for this goal:",r),r.length>0){let e=Math.max(...r.map(e=>e.length));console.log("Number of subgoals to aggregate:",e),a=[],console.log("Using userSubgoalProgress from state:",T);for(let n=0;n<e;n++){let e=r.map(e=>e[n]).filter(e=>null!=e);if(console.log("Subgoal ".concat(n+1," progresses:"),e),e.length>0){let r=Math.round(e.reduce((e,r)=>e+r,0)/e.length);a.push(r),console.log("Subgoal ".concat(n+1," average progress:"),r)}else a.push(0),console.log("Subgoal ".concat(n+1," no progress data, defaulting to 0"))}console.log("Final aggregated progress data for this goal:",a)}else console.log("No relevant progress data found for this goal")}else console.log("No conversations available for progress data");return console.log("=== END PROGRESS DATA AGGREGATION DEBUG ==="),(0,n.jsx)(v,{goal:i,index:r,progressData:a,userSubgoalProgress:T},e)})})}):(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.8rem",textAlign:"center",fontFamily:"AR One Sans, Arial, sans-serif"},children:"No goals set yet"})]})]}),(0,n.jsxs)(d.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-lg p-8 border border-gray-200",children:[(0,n.jsx)("h3",{style:{color:"var(--rose-primary)",fontSize:"1.3rem",fontWeight:600,marginBottom:"1rem",fontFamily:"Gabriela, Arial, sans-serif"},className:"font-heading",children:"\uD83C\uDFAD Saved Personas"}),z?(0,n.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"var(--rose-primary)",fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:"Loading personas..."}):0===(k||[]).length?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"var(--rose-primary)",background:"rgba(126,90,117,0.05)",borderRadius:12,border:"2px dashed rgba(126,90,117,0.2)",fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"\uD83C\uDFAD"}),(0,n.jsx)("div",{style:{fontWeight:600,marginBottom:"0.5rem",fontFamily:"Gabriela, Arial, sans-serif"},children:"No personas saved yet"}),(0,n.jsx)("div",{style:{fontSize:"0.9rem",opacity:.8},children:"End a conversation to save it as a reusable persona"})]}):(0,n.jsx)("div",{style:{display:"flex",gap:"1rem",overflowX:"auto",padding:"0.5rem 0",scrollbarWidth:"thin",scrollbarColor:"var(--rose-accent) transparent"},children:(k||[]).map(e=>{var r,a,i;return(0,n.jsxs)("div",{style:{minWidth:"200px",maxWidth:"200px",background:"rgba(126,90,117,0.05)",borderRadius:16,padding:"1.5rem",border:"2px solid rgba(126,90,117,0.1)",transition:"all 0.3s ease",cursor:"pointer",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 25px rgba(126,90,117,0.15)",e.currentTarget.style.borderColor="rgba(126,90,117,0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="rgba(126,90,117,0.1)"},children:[(0,n.jsx)("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"linear-gradient(135deg, var(--rose-primary) 0%, #8a6a7a 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem auto",fontSize:"1.5rem",color:"#fff",fontWeight:"bold",fontFamily:"Montserrat, Arial, sans-serif"},children:e.name.charAt(0).toUpperCase()}),(0,n.jsx)("div",{style:{textAlign:"center",fontWeight:600,color:"var(--rose-primary)",fontSize:"1rem",marginBottom:"0.5rem",fontFamily:"Montserrat, Arial, sans-serif"},className:"font-body",children:e.name}),e.description&&(0,n.jsx)("div",{style:{color:"var(--rose-accent)",fontSize:"0.8rem",textAlign:"center",marginBottom:"0.75rem",lineHeight:"1.3",fontFamily:"AR One Sans, Arial, sans-serif",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},className:"font-body",children:e.description}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"0.25rem"},children:[(0,n.jsxs)("span",{style:{background:"rgba(126,90,117,0.1)",color:"var(--rose-primary)",padding:"0.15rem 0.4rem",borderRadius:8,fontSize:"0.65rem",fontFamily:"AR One Sans, Arial, sans-serif",fontWeight:500},children:[J(e.language).flag," ",e.language.toUpperCase()]}),(0,n.jsx)("span",{style:{background:"rgba(126,90,117,0.1)",color:"var(--rose-primary)",padding:"0.15rem 0.4rem",borderRadius:8,fontSize:"0.65rem",fontFamily:"AR One Sans, Arial, sans-serif",fontWeight:500},children:e.formality})]}),(null==(r=e.topics)?void 0:r.length)>0&&(0,n.jsxs)("div",{style:{textAlign:"center",color:"var(--rose-accent)",fontSize:"0.7rem",fontFamily:"AR One Sans, Arial, sans-serif",opacity:.8},children:[null==(a=e.topics)?void 0:a.slice(0,2).join(", "),(null==(i=e.topics)?void 0:i.length)>2&&"..."]})]}),(0,n.jsx)("button",{onClick:r=>{r.stopPropagation(),P(e.id)},style:{position:"absolute",top:"0.5rem",right:"0.5rem",color:"#dc3545",background:"rgba(220,53,69,0.1)",border:"none",borderRadius:"50%",width:"24px",height:"24px",fontSize:"0.7rem",cursor:"pointer",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif",display:"flex",alignItems:"center",justifyContent:"center"},title:"Delete persona",onMouseEnter:e=>{e.currentTarget.style.background="rgba(220,53,69,0.2)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(220,53,69,0.1)"},children:"\xd7"})]},e.id)})})]}),(0,n.jsxs)(d.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},className:"bg-white rounded-lg shadow-lg p-8 border border-gray-200",children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,n.jsx)("h3",{style:{color:"var(--blue-secondary)",fontSize:"1.3rem",fontWeight:600,fontFamily:"Gabriela, Arial, sans-serif"},className:"font-heading",children:"Recent Conversations"}),(0,n.jsx)("button",{onClick:()=>{let e=localStorage.getItem("subgoal_progress_".concat(null==p?void 0:p.id,"_").concat(x));if(console.log("Current localStorage subgoal progress:",e),e)try{let r=JSON.parse(e);console.log("Parsed subgoal progress:",r)}catch(e){console.error("Error parsing localStorage:",e)}},style:{padding:"0.25rem 0.5rem",border:"1px solid var(--rose-accent)",borderRadius:"4px",background:"transparent",color:"var(--rose-accent)",cursor:"pointer",fontSize:"0.7rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif"},children:"\uD83D\uDD0D Debug"})]}),z?(0,n.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"var(--rose-primary)",fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:"Loading conversations..."}):C?(0,n.jsx)("div",{style:{color:"#dc3545",textAlign:"center",padding:"2rem",fontFamily:"Montserrat, Arial, sans-serif"},className:"font-body",children:C}):0===(S||[]).length?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"2rem",color:"var(--rose-primary)",background:"rgba(126,90,117,0.05)",borderRadius:12,border:"2px dashed rgba(126,90,117,0.2)",fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"\uD83C\uDFA4"}),(0,n.jsx)("div",{style:{fontWeight:600,marginBottom:"0.5rem",fontFamily:"Gabriela, Arial, sans-serif"},children:"Start your first conversation!"}),(0,n.jsxs)("div",{style:{fontSize:"0.9rem",opacity:.8},children:['Click "Practice Now" to begin learning ',U?J(U.language).label:"your language"]})]}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:(S||[]).slice(0,5).map(e=>{let r=localStorage.getItem("subgoal_progress_".concat(null==p?void 0:p.id,"_").concat(x)),a=[];if(r)try{a=JSON.parse(r)}catch(e){console.error("Error parsing stored subgoal progress:",e)}return(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.05)",borderRadius:12,padding:"1rem",border:"1px solid rgba(126,90,117,0.1)",transition:"all 0.3s ease"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1},children:[e.uses_persona&&(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",background:"rgba(126,90,117,0.1)",padding:"0.2rem 0.5rem",borderRadius:8,fontSize:"0.7rem",color:"var(--rose-primary)",fontWeight:500,fontFamily:"Montserrat, Arial, sans-serif",flexShrink:0},children:["\uD83C\uDFAD ",e.persona_name||"Persona"]}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem",flexWrap:"wrap"},children:[(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--blue-secondary)",fontFamily:"Montserrat, Arial, sans-serif",flex:"1 1 auto",minWidth:0},className:"font-body",children:e.title||"Untitled Conversation"}),(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.8rem",fontFamily:"AR One Sans, Arial, sans-serif",flexShrink:0},className:"font-body",children:new Date(e.created_at).toLocaleDateString()})]}),e.persona_description&&(0,n.jsxs)("div",{style:{color:"var(--rose-accent)",fontSize:"0.8rem",marginBottom:"0.25rem",fontFamily:"AR One Sans, Arial, sans-serif",fontStyle:"italic"},className:"font-body",children:['"',e.persona_description,'"']}),e.message_count&&e.message_count>0&&(0,n.jsxs)("div",{style:{color:"var(--rose-primary)",fontSize:"0.9rem",opacity:.8,fontFamily:"AR One Sans, Arial, sans-serif"},className:"font-body",children:["\uD83D\uDCAC ",e.message_count," messages"]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-start",flexShrink:0,marginLeft:"0.5rem"},children:[(0,n.jsx)(l(),{href:"/analyze?conversation=".concat(e.id,"&language=").concat(U.language),style:{color:"var(--rose-primary)",fontWeight:600,textDecoration:"none",fontSize:"0.9rem",padding:"0.25rem 0.75rem",borderRadius:6,background:"rgba(126,90,117,0.1)",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif"},children:"Continue →"}),(0,n.jsx)("button",{onClick:()=>M(e.id),style:{color:"#dc3545",background:"rgba(220,53,69,0.1)",border:"none",borderRadius:6,padding:"0.25rem 0.5rem",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.3s ease",fontFamily:"Montserrat, Arial, sans-serif"},title:"Delete conversation",children:"\uD83D\uDDD1️"})]})]}),e.synopsis&&(0,n.jsx)("div",{style:{marginTop:"0.75rem",background:"rgba(126,90,117,0.05)",padding:"0.75rem",borderRadius:8,border:"1px solid rgba(126,90,117,0.1)",overflow:"hidden",transition:"all 0.3s ease"},children:(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("button",{onClick:()=>{var r;return r=e.id,void I(e=>{let a=new Set(e);return a.has(r)?a.delete(r):a.add(r),a})},style:{position:"absolute",top:0,right:0,color:"var(--rose-primary)",background:"transparent",border:"none",fontSize:"0.8rem",cursor:"pointer",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif",display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem",borderRadius:"4px",transition:"all 0.3s ease",zIndex:10},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(126,90,117,0.1)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:W.has(e.id)?"Show Less ↑":"Show Details ↓"}),(0,n.jsx)("div",{style:{color:"var(--blue-secondary)",fontSize:"0.9rem",lineHeight:1.6,fontFamily:"AR One Sans, Arial, sans-serif",wordBreak:"break-word",paddingTop:"2rem",maxHeight:W.has(e.id)?"1000px":"4.5rem",overflow:"hidden",transition:"max-height 0.3s ease",whiteSpace:W.has(e.id)?"pre-wrap":"normal"},className:"font-body",children:W.has(e.id)?(()=>{let r=X(e.synopsis||"",e,a||[]);return"structured"===r.type&&r.evaluations?(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.evaluations.map((e,r)=>(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.03)",border:"1px solid rgba(126,90,117,0.1)",borderRadius:"8px",padding:"0.75rem"},children:[(0,n.jsxs)("div",{style:{fontWeight:600,color:"var(--blue-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem",fontFamily:"Montserrat, Arial, sans-serif",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{children:e.title}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("span",{style:{color:"var(--rose-accent)",fontSize:"0.7rem",fontWeight:500,fontFamily:"Montserrat, Arial, sans-serif"},children:q.formatLevelDisplay(e.level,"recent-conversations",e.percentage)}),(0,n.jsxs)("span",{style:{color:"var(--rose-primary)",fontSize:"0.75rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif"},children:[e.percentage,"%"]})]})]}),(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.8rem",lineHeight:1.5,fontFamily:"AR One Sans, Arial, sans-serif"},children:e.content})]},r))}):r.content})():(()=>{let r=X(e.synopsis||"",e,a||[]);if("structured"===r.type&&r.evaluations){let e=r.evaluations[0];if(e)return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,n.jsxs)("div",{style:{background:"rgba(126,90,117,0.03)",border:"1px solid rgba(126,90,117,0.1)",borderRadius:"8px",padding:"0.5rem"},children:[(0,n.jsxs)("div",{style:{fontWeight:600,color:"var(--blue-secondary)",fontSize:"0.8rem",marginBottom:"0.25rem",fontFamily:"Montserrat, Arial, sans-serif",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{children:e.title}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,n.jsx)("span",{style:{color:"var(--rose-accent)",fontSize:"0.65rem",fontWeight:500,fontFamily:"Montserrat, Arial, sans-serif"},children:q.formatLevelDisplay(e.level,"recent-conversations",e.percentage)}),(0,n.jsxs)("span",{style:{color:"var(--rose-primary)",fontSize:"0.65rem",fontWeight:600,fontFamily:"Montserrat, Arial, sans-serif"},children:[e.percentage,"%"]})]})]}),(0,n.jsxs)("div",{style:{color:"var(--rose-primary)",fontSize:"0.75rem",lineHeight:1.4,fontFamily:"AR One Sans, Arial, sans-serif"},children:[e.content.substring(0,120),"..."]})]}),r.evaluations.length>1&&(0,n.jsxs)("div",{style:{color:"var(--rose-accent)",fontSize:"0.7rem",fontStyle:"italic",fontFamily:"AR One Sans, Arial, sans-serif"},children:["+",r.evaluations.length-1," more evaluations"]})]})}var i=r.content||"";let o=i.split(".")[0];return o.length>100?o.substring(0,100)+"...":o+(i.includes(".")?".":"")})()})]})}),!e.synopsis&&(0,n.jsx)("div",{style:{color:"var(--rose-primary)",fontSize:"0.8rem",fontStyle:"italic",marginTop:"0.5rem"},children:"No synopsis available"})]},e.id)})})]})]})]}),U&&(0,n.jsx)(h,{dashboard:U,isOpen:N,onClose:()=>B(!1),onUpdate:e=>{b(r=>r.map(r=>r.language===e.language?e:r))},onDelete:e=>{if(b(r=>r.filter(r=>r.language!==e)),x===e){var r;j(null==(r=f.filter(r=>r.language!==e)[0])?void 0:r.language)}}})]})}},9160:(e,r,a)=>{Promise.resolve().then(a.bind(a,7701))}},e=>{e.O(0,[9135,1497,2451,8789,2619,335,51,8441,1255,7358],()=>e(e.s=9160)),_N_E=e.O()}]);